---
title: "Hurricane Maria Mortality Rate"
description: |
  In 2018 [@kishore2018] was published and created significant controversy around data accuracy, measurement technique differences and overall plausibility. This website aims to display and comment on these issues.
authors:
  - name: David D. Kane
  - name: Shreeram Patkar
site: distill::distill_website
bibliography: bibliography.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(distill)
library(plotly)
library(ggthemes)
library(ggplot2)
library(lubridate)
library(gganimate)
theme_set(theme_bw())

official_deaths_raw <- read.csv(file = "official-deaths.csv")
deaths_official <- readRDS("deaths_official.RDS")
world_bank_deaths <- read.csv(file ="world_bank_deaths.csv")

# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html

# Learn more about publishing to GitHub Pages at:
# https://rstudio.github.io/distill/publish_website.html#github-pages

```

```{r}

deaths_clean <- deaths_official %>% 
  pivot_longer(cols = c(-Year,-Pop, -Popv17), names_to = "Month") %>% 
  mutate(date = paste(1,Month,Year)) %>% 
  mutate(xdate = parse_date_time(x = date, orders = "dmy")) %>% 
  mutate(d_rate = (value/Pop)*1000) %>% 
  select(xdate, d_rate, value, Pop)

wb_clean <- world_bank_deaths %>% 
  filter(Country.Code == "PRI") %>% 
  select(X2010:X2017) %>% 
  pivot_longer(cols = X2010:X2017, names_to = "Year", values_to = "Death_Rate") %>% 
  mutate(Year = str_remove(string = Year, pattern = "X"))
```


```{r, fig.align="center", fig.cap="This plot is a histogram of the monthly mortality rates from 2010 to 2017 (before Hurricane Maria) in Puerto Rico. The x-axis is the monthly mortality rate and the y-axis is the count. The arrow points to the monthly mortality rate as per [@kishore2018]'s calculations. In all, it is evident that the study's estimate is implausibly low"}

p1<- deaths_clean %>% 
  ggplot(aes(x= d_rate))+
  geom_histogram(color = "grey50", bins = 30, fill = "deepskyblue")+
  #geom_vline(xintercept = (5.07/12),linetype="dashed", color = "grey50", size = 1)+
  geom_label(aes(0.45, 7.5, label = "Kishore et. al \nmonthly mortality \nrate before Maria"),
             label.size = 0,  color = "grey50", size = 3.5, nudge_x = 0.08)+
  labs(title = "Monthly Official Mortality Rates",
       subtitle = "Kishore et. al pre-Maria estimate is implausibly lower",
       x = "Monthly Mortality Rate (Deaths per 1000 per Month) ",
       y = "Count")+
  theme_clean()+
  geom_segment(aes(x = 0.473, y = 7, xend = 5.07/12, yend = 0),
                  arrow = arrow(length = unit(0.5, "cm")), color = "grey", size = 1)

p1

```


<!-- This plot is a histogram of the monthly mortality rates from 2010 to 2017 (before Hurricane Maria) in Puerto Rico. The x-axis is the monthly mortality rate ($deaths_{monthly} / population_{annual} * 1000$) and the y-axis is the count. The dotted line represents the monthly mortality rate as per [@kishore2018]'s calculations. The original calculation in [@kishore2018] produced an annual mortality rate and was thus divided by twelve to be plotted on this graph.  -->


### Calculation

#### [N/A]
